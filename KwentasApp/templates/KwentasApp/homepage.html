{% load static %}
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="shortcut icon" type="x-icon" href="{% static 'KwentasApp/img/logobrowser.jpg' %}">
    <title>Kwentas Klaras - Home</title>
    <!-- Font Awesome CDN-->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"/>
    <!-- Stylesheet -->
    <link rel="stylesheet" href="{% static 'KwentasApp/css/homepage.css' %}" />
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  </head>
  <body>
    <section>
      <div class="row">
        <h1 class="section-heading">KWENTAS KLARAS DIGITAL PMIS V 1.0</h1>
      </div>
      <div class="row">
        <div class="column">
          <div class="card">
            <div class="icon-wrapper">
              <i class="fas fa-project-diagram"></i>
            </div>
            <h3>Programs Projects & Activities under 20% LDF</h3>
            <p>
              <form action="{% url 'continuing_projects' %}" method="get">
                <button type="submit" class="btn"><i class="fas fa-table"></i> Continuing</button>
              </form>
              <form action="{% url 'ongoing_projects' %}" method="get">
                <button type="submit" class="btn"><i class="fas fa-table"></i> Current </button>
              </form>
              <form action="{% url 'adddata' %}" method="get">
                <button type="submit" class="btn"><i class="fas fa-search"></i> Add Data</button>
              </form>
            </p>
          </div>
        </div>
        <div class="column">
          <div class="card">
            <div class="icon-wrapper">
              <i class="fas fa-money-bill-alt"></i>
            </div>
            <h3>PROCUREMENTS</h3>
            <p>
              <button type="button" class="btn">PPMP</button>
              <button type="button" class="btn">APP</button>
              <button type="button" class="btn">Procurement Timelines</button>
            </p>
          </div>
        </div>
        <div class="column">
          <div class="card">
            <div class="icon-wrapper">
              <i class="fas fa-money-check-alt"></i>
            </div>
            <h3>OBLIGATIONS / DISBURSEMENTS</h3>
            <form action="" method="get">
              <button type="submit" class="btn">Obligations</button>
            </form>
            <p>
              <form action="" method="get">
                <button type="submit" class="btn">Disbursement</button>
              </form>
              <button type="button" class="btn">Check Payment</button>
            </p>
          </div>
        </div>
        <div class="column">
          <div class="card">
            <div class="icon-wrapper">
              <i class="fas fa-eye"></i>
            </div>
            <h3>MONITORING & EVALUATION</h3>
            <p>
              Monitor and evaluate existing projects.
            </p>
          </div>
        </div>
        <div class="column">
          <a href="{% url 'reports' %}" style="text-decoration: none;">
            <div class="card">
                <div class="icon-wrapper">
                    <i class="fas fa-chart-line"></i>
                </div>
                <h3>REPORTS</h3>
                <p>
                    View Reports
                </p>
            </div>
        </a>
        </div>
        <div class="column">
          <div class="card">
            <div class="icon-wrapper">
              <i class="fas fa-person"></i>
            </div>
            <h3>Logged in as {{ user_name }}</h3>
            <p>
              <form action="{% url 'admin:index' %}" method="post">
                {% csrf_token %}
                <button type="submit" class="btn"><i class="fas fa-person"></i> Admin</button>
              </form>
              <form action="{% url 'register' %}" method="post">
                {% csrf_token %}
                <button type="submit" class="btn"><i class="fas fa-add"></i> Add Account</button>
              </form>
              <form action="{% url 'logout' %}" method="post">
                {% csrf_token %}
                <button type="submit" class="btn"><i class="fas fa-sign-out-alt"></i> Logout</button>
              </form>
            </p>
          </div>
        </div>
      </div>
    </section>
    <script>
      const notifications = document.querySelector(".notifications");
    
      // Object containing details for different types of toasts
      const toastDetails = {
          timer: 5000,
          success: {
              icon: 'fa-circle-check',
              text: 'Welcome to Kwentas Klaras, {{ user_name }}',
          }
      }
    
      const removeToast = (toast) => {
          toast.classList.add("hide");
          if (toast.timeoutId) clearTimeout(toast.timeoutId); // Clearing the timeout for the toast
          setTimeout(() => toast.remove(), 500); // Removing the toast after 500ms
      }
    
      const createToast = (id) => {
          // Getting the icon and text for the toast based on the id passed
          const { icon, text } = toastDetails[id];
          const toast = document.createElement("li"); // Creating a new 'li' element for the toast
          toast.className = `toast ${id}`; // Setting the classes for the toast
          // Setting the inner HTML for the toast
          toast.innerHTML = `<div class="column">
                               <i class="fa-solid ${icon}"></i>
                               <span>${text}</span>
                            </div>
                            <i class="fa-solid fa-xmark" onclick="removeToast(this.parentElement)"></i>`;
          notifications.appendChild(toast); // Append the toast to the notification ul
          // Setting a timeout to remove the toast after the specified duration
          toast.timeoutId = setTimeout(() => removeToast(toast), toastDetails.timer);
      }
    
      // Function to show a toast message after logging in
      const showLoginToast = () => {
        createToast('success');
      }
    
      // Call the function to show the toast when the page loads
      window.addEventListener('DOMContentLoaded', (event) => {
        showLoginToast();
      });
    </script>


<script>
  document.addEventListener('DOMContentLoaded', function () {
  const body = document.querySelector('body');

  // Add class to body when page loads
  body.classList.add('page-loaded');
});
</script>

{% if request.session.just_logged_in %}
<script>
  // Function to display a SweetAlert message with dynamic greeting based on time
  function showWelcomeMessage(userName) {
      const now = new Date();
      const hours = now.getHours();

      let greeting = '';

      if (hours >= 5 && hours < 12) {
          greeting = 'Good Morning';
      } else if (hours >= 12 && hours < 18) {
          greeting = 'Good Afternoon';
      } else {
          greeting = 'Good Evening';
      }

      // Display the dynamic greeting message
      Swal.fire({
          icon: 'success',
          title: `${greeting}, Welcome to Kwentas Klaras`,
          text: `${userName}`,
          timer: 3700, // Set the timer for the message to automatically disappear after 3 seconds
          confirmButtonText: 'Proceed', // Change the text of the OK button to Proceed
          customClass: {
              confirmButton: 'green-btn' // Apply custom class to confirm button
          }
      });
  }

  // Update the clock every second
  function updateClock() {
      const now = new Date();
      const timeElement = document.getElementById('clock');
      timeElement.textContent = now.toLocaleTimeString();
  }

  // Call the function to display the message and update the clock when the page loads
  window.addEventListener('DOMContentLoaded', () => {
      // Check if the user has just logged in
      
          // Get the username from a global variable or other means
          const userName = '{{ request.user.name }}'; // Replace this with actual logic to get the username
          showWelcomeMessage(userName);
          // Unset the just_logged_in session variable
          fetch("{% url 'unset_just_logged_in' %}");
    
      
      setInterval(updateClock, 1000); // Update the clock every second
  });
  
</script>
{% endif %}

<style>
  .green-btn {
    background-color: #00AB66 !important;
    border: none !important; /* Remove the border */
    box-shadow: none !important; /* Remove the box shadow */
  }
</style>
  </body>
</html>
